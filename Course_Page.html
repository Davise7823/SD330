<!doctype html>
<html lang="eng">
	<head>
		<meta charset="utf-8">
		<title>FoxBooks</title>
		<link rel="stylesheet" type="text/css" href="Foxbooks.css" />
	</head>
	<body>
		<h1>FoxBooks</h1>
		<div id="course_selection">
			<h2>Find Your Textbooks:</h2>
			<p>Enter the CRN:</p>
			<select name="" id="CRN">
					<option value=""></option>
			</select>
			<p>Enter the Section:</p>
			<select name="" id="Section">
			<optgroup label="">
					<option value="" selected="selected"></option>
			</optgroup>
			</select>
			<input type="submit" value="Submit" id="btn"/>
		</div>
		<h1 id="Course_Info"></h1>
		<script>
			selectCRN = document.getElementById("CRN").value;
			selectSection = document.getElementById("Section").value;
			courseInfo = document.getElementById("Course_Info");
			button = document.getElementById("btn");
			

			async function getData(){
				//try this code, if it doesn't work...
				try{
					let response = await fetch('https://davise7823.github.io/SD330/foxbooks.json'); // make a request to a JSON endpoint
					let data = await response.json(); // parse the response as JSON

					//populates the "CRN" selection list
					for (let i = 0; i < data.courses.length; i++){
						var x = document.getElementById("CRN");
						var option = document.createElement("option");
						option.text = data.courses[i].CRN;
						x.add(option);
					}
					
					//populates the "Section" selection list
					for (let i = 0; i < data.courses.length; i++){
						var x = document.getElementById("Section");
						var option = document.createElement("option");
						option.text = data.courses[i].Section;
						x.add(option);
					}
					
					//If one is selected display it in the course info element
					button.addEventListener("click", () => {
						if(selectCRN == data.courses[0].CRN){
							courseInfo.innerHTML = data.courses[0].Name;
						}else if(selectCRN == data.courses[1].CRN){
							courseInfo.innerHTML = data.courses[1].Name;
						}else if(selectCRN = data.courses[2].CRN){
							courseInfo.innerHTML = data.courses[2].Name;
						}else if(selectCRN == data.courses[3].CRN){
							courseInfo.innerHTML = data.courses[3].Name;
						}else if(selectCRN == data.courses[4].CRN){
							courseInfo.innerHTML = data.courses[4].Name;
						}else if(selectCRN == data.courses[5].CRN){
							courseInfo.innerHTML = data.courses[5].Name;
						}else if(selectCRN == data.courses[6].CRN){
							courseInfo.innerHTML = data.courses[6].Name;
						}else if(selectCRN == data.courses[7].CRN){
							courseInfo.innerHTML = data.courses[7].Name;
						}else{
							courseInfo.innerHTML = "";
						}
					});
				}
				//run this code to show any errors
				catch (error) {
					console.error(error); // handle any errors
			  	}
			}
			getData();
			
			/*fetch("https://davise7823.github.io/SD330/foxbooks.json",{method: "GET"}).then((response) => {
				//console.log('resolved', response);
				return response.json();
			}).then(data => {
				//console.log(data.courses[3].CRN);
				for (let i = 0; i < data.courses.length; i++){
					var x = document.getElementById("CRN");
					var option = document.createElement("option");
					option.text = data.courses[i].CRN;
					x.add(option);
				}
				//console.log(data.courses[3].Section);
				for (let i = 0; i < data.courses.length; i++){
					var x = document.getElementById("Section");
					var option = document.createElement("option");
					option.text = data.courses[i].Section;
					x.add(option);
				}
			}).catch((err) => {
				console.log('rejected', err);
			})*/
		</script>
		<footer>
			<hr />
			<small>&copy Elijah D - 09/25/23</small>
		</footer>
	</body>
</html>
